{% extends 'gifts/base.html' %}
{% load static %}

{% block content %}

<div class="content container">

    <h1>{{group.name}}</h1>

    {% if user_is_admin %}
    <a href="{% url 'edit_group' group.id %}"><button class="btn orange">Edit</button></a>
    {% endif %}
    <a href="{% url 'leave_group' group.id %}"><button class="btn red">Leave group</button></a>
    <a onclick="refresh_gifts_ajax('{{group.id}}')" class="btn green right tooltipped" data-position="bottom" data-tooltip="Check for new gifts. This will be done for you every 24 hours">
        <i id="gift-refresh" class="material-icons left">refresh</i>
    <!-- Spinner -->
          <div style="display:none;" id="gift-collection-loading" class="preloader-wrapper small active">
            <div class="spinner-layer spinner-blue-only">
              <div class="circle-clipper left">
                <div class="circle"></div>
              </div><div class="gap-patch">
                <div class="circle"></div>
              </div><div class="circle-clipper right">
                <div class="circle"></div>
              </div>
            </div>
          </div>
      <!-- End Spinner -->
        Refresh Gifts
    </a>

    <div class="row">
        <div class="col s12 offset-m2 m8 l7">
            <p>Members</p>
            <ul class="collection">
                {% for member in members %}
                <li class="collection-item avatar">
                    <img src="{{member.profile.get_profile_pic}}" alt="" class="circle">
                    <!-- <i class="material-icons circle">folder</i> -->
                    <span class="title">{{member.first_name}} {{member.last_name}}</span>
                    <p>First Line</p>
                    {% if member.is_admin %}<i class="material-icons secondary-content yellow-text tooltipped" data-position="right" data-tooltip="Admin">verified</i>
                    {% elif user_is_admin %}
                    <a href="{% url 'group_grant_admin' group_id=group.id user_id=member.id %}">
                        <i class="material-icons secondary-content green-text tooltipped" data-position="right" data-tooltip="Make admin">add_circle</i>
                    </a>
                    {% else %}
                    <i class="material-icons secondary-content teal-text">account_circle</i>
                    {% endif %}

                 </li>
                {% endfor %}
            </ul>
            {% if group.standard_user_can_invite or user_is_admin %}
            <form method="POST">
                {% csrf_token %}
                {{invitation_form.invitee_email}}
                <button class="btn green">Invite</button>
                {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                    <li class="{{ message.tags }}">{{ message }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </form>
            {% endif %}
        </div>

        <div class="col s12 offset-m2 m8 l5" id="gifts-collection">
            {{group_gifts_component}}
        </div>

    </div>
</div>
{% endblock %}

{% block end_scripts %}
<script src="{% static 'gifts/js/viewIndividualGroup.js'%}"></script>
{% endblock %}